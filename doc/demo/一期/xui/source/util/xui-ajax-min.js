xui.util.Ajax={asyncGET:function(b,c,d){var a=this._createHTTP();a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){xui.util.Ajax._callback(c,a.responseText)}else{xui.util.Ajax._callback(d,a.responseText)}}};a.open("get",xui.util.Ajax._newURL(b),true);a.send(null)},_iframeCallback:{},_iframeOnload:function(b){try{xui.util.Ajax._callback(xui.util.Ajax._iframeCallback[b],window.frames[b].document.body.innerHTML)}catch(a){}},asyncPOST:function(b,g,c,f){var a=this._createHTTP();a.onreadystatechange=function(){if(a.readyState==4){if(a.status==200){xui.util.Ajax._callback(c,a.responseText)}else{xui.util.Ajax._callback(f,a.responseText)}}};a.open("POST",b,true);a.setRequestHeader("cache-control","no-cache");a.setRequestHeader("CONTENT-TYPE","application/x-www-form-urlencoded;");var e="ts="+new Date().getTime()+"&"+g;a.setRequestHeader("Content-Length",e.length);a.send(e)},asyncPOSTForm:function(a,d,b){var c=typeof d=="string"?$(d):d;var g=$UUID("xaj_");xui.util.Ajax._iframeCallback[g]=b;var e=document.createElement("span");e.style.display="none";e.innerHTML='<iframe id="'+g+'" name="'+g+'" src="javascript:false;" onload="xui.util.Ajax._iframeOnload(this.id);" style="width:0px;height:0px;"></iframe>';document.body.appendChild(e);c.action=a;c.target=g;c.method="post";c.submit()},syncGet:function(b){var a=this._createHTTP();a.open("get",xui.util.Ajax._newURL(b),false);a.setRequestHeader("cache-control","no-cache");a.send(null);if(a.readyState==4){if(a.status==200){return xui.util.Ajax._trim(a.responseText)}else{return null}}},asyncGETProxy:function(attrs,callback){var script=document.createElement("script");script.setAttribute("type","text/javascript");if(attrs.charset){script.setAttribute("charset",attrs.charset)}var url=attrs.url;if(attrs.vName){url+=(url.indexOf("?")>-1?"":"?")+"&_xui_ajax_callback="+attrs.vName}script.src=xui.util.Ajax._newURL(url);if(document.all){script.onreadystatechange=function(){var rs=this.readyState;if("loaded"===rs||"complete"===rs){try{xui.util.Ajax._callback(callback,eval(attrs.vName))}catch(e){}this.onreadystatechange=null;this.parentNode.removeChild(this)}}}else{script.async=true;script.onload=function(){try{xui.util.Ajax._callback(callback,eval(attrs.vName))}catch(e){}this.onreadystatechange=null;this.parentNode.removeChild(this)}}document.body.appendChild(script)},_createHTTP:function(){var a;try{a=new XMLHttpRequest()}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){a=null}}}return a},_newURL:function(a){if(a.indexOf("?")>0){s=a+"&ts="+new Date().getTime()}else{s=a+"?ts="+new Date().getTime()}return s},_callback:function(a,b){if(a){a.call(this,xui.util.Ajax._trim(b))}},_trim:function(a){if(a&&a.length>0){return a.replace(/(^\s*)|(\s*$)/g,"")}return""}};
