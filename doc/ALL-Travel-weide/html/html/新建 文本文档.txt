<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<title>度假OK</title>
<link rel="stylesheet" type="text/css" href="../css/General.css"/>
<link rel="stylesheet" type="text/css" href="../css/base.css"/>
<script type="text/javascript" src="../xui/source/core/xui-core.js"></script>
<script type="text/javascript" src="../xui/source/util/util.js"></script></head>
<body>
	<div class="navbar">
    	<div class="navbar_com FS12">欢迎您：SUNPEA张博童鞋&nbsp;&nbsp;&nbsp;&nbsp;<a href="#">我的订单</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">修改个人资料</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">退出</a>&nbsp;&nbsp;</div>
   		</div>
        <div class="page_bg">
            <div id="wrap" class="FS12 F2">
            <div class="header_bg"> 
                <div id="header" class="section">
                    <div class="header_1">
                        <div class="logo"></div>
                    </div>
                </div>
                <div class="header_tab section">
                	<ul class="FS14 B">
                    	<li class="cur"><a href="#">首页</a></li>
                        <li><a href="#">周边自驾</a></li>
                        <li><a href="#">度假酒店</a></li>
                        <li><a href="#">打着门票</a></li>
                    </ul>
                    <span class="theme_link"><a href="#">旅游攻略</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">景点大全</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="#">订购指南</a></span>
                </div>
             </div>
            
<!-- 内容开始 -->
        <div id="wrap">
            <div class="section urhere">
            	<p class="F3">您当前的位置： 浙江 > 嘉兴 > 桐乡乌镇</p>
                <span class="F3">分享到： 新浪微博 </span>
            </div>
            
            <div id="dingdan" class="section">
            	<div class="d_left">
                	<h2 class="d_title yuding01">【周边游】桐乡乌镇一日游 中国最后的枕水人家 似水年华</h2>
                    <h3 class="dingdanhead">订购产品</h3>
                    <table class="d_dgcp"  cellpadding="0" cellspacing="0">
                    	<tr>
                        	<th>编号</th>
                            <th>线路名称</th>
                            <th>出发信息</th>
                            <th>人数</th>
                        </tr>
                        <tr>
                        	<td>588156237</td>
                            <td>桐乡乌镇一日游 中国最后的枕水人家 似水年华</td>
                            <td class="F10">杭州<br />2011-06-11</td>
                            <td class="F10">成人 <input type="text" name="Adult_Num" id="Adult_Num" maxlength="3" class="wpx34" /><span class="F2">（市场价：<span id="Adult_price">567</span>元）</span><br />儿童 <input type="text" name="Child_Num" id="Child_Num" maxlength="3" class="wpx34" /><span class="F2">（市场价：<span id="Child_price">567</span>元）</span></td>
                        </tr>
                    </table>
                    <h3 class="dingdanhead">附加产品</h3>
                    <ul class="Insurance clearFix">
                    	<li class="clearFix">
                        	<ul class="Insurance_one">
                            	<li class="Insurance_check"><input name="Accident_Insurance" type="checkbox" value="" id="Accident_Insurance" checked /></li><li class="Insurance_name">自由行-平安国内短途2日游意外险</li><li>市场价：<span id="Insurance_mkprice">10</span>元</li><li>ok价：<span id="Insurance_okprice">2</span>元</li><li><span class="F10" id="Insurance_oknum">3</span>　份</li><li><span class="F9"><span id="Insurance_okTotal">6</span>元</span></p></li>
                            </ul>
                       </li>
                       <li class="clearFix">
                        	<ul class="Insurance_one">
                            	<li class="Insurance_check"><input name="Room_rate" type="checkbox" id="Room_rate" value="" /></li><li class="Insurance_name">房间房费差额补价</li><li>市场价：<span id="Room_mkprice">124</span>元</li><li>ok价：<span id="Room_okprice">24</span>元</li><li><span class="F10" id="Room_oknum">3</span>　间</li><li><span class="F9"><span id="Room_okTotal">6</span>元</span></p></li>
                            </ul>
                       </li>
                    </ul>
                    <h3 class="dingdanhead">主联系人信息</h3>
                    <table class="d_ywrxx"  cellpadding="0" cellspacing="0">
                    	<tr>
                        	<th><i>*</i> 主联系人姓名：</th>
                            <td><input type="text" name="erh" id="erh" class="wpx184" /></td>
                        </tr>
                        <tr>
                        	<th><i>*</i> 主联系人手机：</th>
                            <td><input type="text" name="erh" id="erh" class="wpx184" /></td>
                        </tr>
                        <tr>
                        	<th><i>*</i> 证件类型：</th>
                            <td><form id="form1" name="form1" method="post" action="">
                              <select name="select" id="select">
                                <option>身份证</option>
                                <option>护照</option>
                                <option>军官证</option>
                              </select>
                            </form></td>
                        </tr>
                        <tr>
                        	<th><i>*</i> 证件号码：</th>
                            <td><input type="text" name="erh" id="erh" class="wpx184" /></td>
                        </tr>
                        <tr>
                        	<th>E-mail：</th>
                            <td><input type="text" name="erh" id="erh" class="wpx184" /></td>
                        </tr>
                    </table>
                    <div id="Creat_order" class="hid"></div>
                    <div class="d_qrxd">
                    	<button>&nbsp;&nbsp;&nbsp;&nbsp;</button>
                    </div>
                    <div class="d_ydxx">
                    	<p><input name="" type="checkbox" value="" checked />同意度假OK预订协议</p>
                    	<textarea name="textarea" id="textarea" cols="45" rows="5">sdfsdfsdfsdfsdfsdfsd</textarea>
                    </div>
              </div>
                
                <div class="d_right">
                	<h3>订单金额总计</h3>
                    <div class="information"> 
                        <table  cellpadding="0" cellspacing="0">
                        	<tr><th>市 场 价：</th><td><span id="Price">2167</span>元</td></tr>
                        	<tr><th>房价差额：</th><td><span id="difference">352</span>元</td></tr>
                            <tr><th>保险费用：</th><td><span id="Total_bx">6</span>元</td></tr>
                            <tr><th>累计节省：</th><td><span id="Total_Save">1458</span>元</td></tr>
                        </table>
                        <p class="Settlement_amount">订单结算金额<br /><b>￥<span id="Order_Total">178370</span></b></p>
                    </div> 
                </div>

            </div>
       </div>    
            <!-- 内容结束 -->
        </div>
    </div>
<script>
var EV = xui.util.Event,
	DOM = xui.util.Dom;
var Totalorders = function(){};
Totalorders.prototype = {
	Total:function(){
		var SELF = this;
		if($('Child_Num')||$('Adult_Num')){
			SELF.Add_Products();
		}
		SELF.Adult_price();
	},
	bind:function(){
		var SELF = this;
		SELF.Creat_order();
		EV.on($('Adult_Num'),'blur',function(){
			SELF.Total();
			SELF.Creat_order();
		})
		EV.on($('Child_Num'),'blur',function(){
			SELF.Total();
		})
		EV.on($('Accident_Insurance'),'click',function(){
			SELF.Total();
			SELF.Creat_order();
		})
		EV.on($('Room_rate'),'click',function(){
			SELF.Total();
		})
	},
	/**
	*订单金额总计数据
	*/
	Adult_price:function(){
		var EL = $('Adult_Num').value,
			EL2 = $('Child_Num').value,
			EL3 = $('Adult_price').innerHTML,
			EL4 = $('Child_price').innerHTML,
			EL5 = $('Insurance_mkprice').innerHTML,
			EL6 = $('Room_okprice').innerHTML,
			EL7 = $('Insurance_okprice').innerHTML,
			EL8 = $('Room_mkprice').innerHTML,
			EL9 = Math.round(EL/2);
		var SELF = this;
		/**
		*选择保险
		*/
		if($('Accident_Insurance').checked){
			if($('Room_rate').checked){
				SELF.Adult_price_init(EL3*EL+EL4*EL2+EL*EL5+EL9*EL8,EL9*(EL8-EL6),(EL+EL2)*EL7,EL9*(EL8-EL6)+(EL)*(EL5-EL7))
			}else{
				SELF.Adult_price_init(EL3*EL+EL4*EL2+EL*EL5,0,(EL+EL2)*EL7,(EL+EL2)*(EL5-EL7))
			}
		/**
		*未选择保险
		*/
		}else{
			if($('Room_rate').checked){
				SELF.Adult_price_init(EL3*EL+EL4*EL2+EL9*EL8,EL9*(EL8-EL6),0,EL9*(EL8-EL6))
			}else{
				SELF.Adult_price_init(EL3*EL+EL4*EL2,0,0,0)
			}
		}
	},
	Adult_price_init:function(num1,num2,num3,num4){
		$('Price').innerHTML = num1;
		$('difference').innerHTML = num2;
		$('Total_bx').innerHTML = num3;
		$('Total_Save').innerHTML = num4;
		$('Order_Total').innerHTML = num1-num4;
	},
	/**
	*附加产品数据
	*/
	Add_Products:function(){
			$('Insurance_oknum').innerHTML = ($('Adult_Num').value-0)+($('Child_Num').value-0);
			$('Insurance_okTotal').innerHTML = $('Insurance_oknum').innerHTML*$('Insurance_okprice').innerHTML;
			$('Room_oknum').innerHTML = Math.round($('Adult_Num').value/2);
			$('Room_okTotal').innerHTML = Math.round($('Adult_Num').value/2)*$('Room_okprice').innerHTML
	},
	Creat_order:function(){
		var EL = $('Adult_Num').value,
			EL2 = $('Creat_order');
		if($('Accident_Insurance').checked){
			if(EL>=2){
				DOM.addClass($('add_order'),'hid')
				DOM.removeClass($('Creat_order'),'hid');
				var Contact = [];
				Contact.push('<h3 class="dingdanhead">游玩人信息</h3>');
				for(i=1; i<EL;i++){
					Contact.push('<table class="d_ywrxx"  cellpadding="0" cellspacing="0"><tr><th><i>*</i> 游玩人姓名：</th><td><input type="text" name="erh_Name'+i+'" id="erh_Name'+i+'" class="wpx184" /></td></tr>');
					Contact.push('<tr><th><i>*</i> 游玩人手机：</th><td><input type="text" name="erh_Tel'+i+'" id="erh_Tel'+i+'" class="wpx184" /></td></tr>');
					Contact.push('<tr><th><i>*</i> 证件类型：</th><td><select name="select" id="select"><option>身份证</option><option>护照</option><option>军官证</optio</select></td></tr>');
					Contact.push('<tr><th><i>*</i> 证件号码：</th><td><input type="text" name="erh_Certificate'+i+'" id="erh_Certificate'+i+'" class="wpx184" /></td></tr>');
					Contact.push('<tr><th>E-mail：</th><td><input type="text" name="erh_Email'+i+'" id="erh_Email'+i+'" class="wpx184" /></td></tr>');
					Contact.push('<tr id="add_order"><th></th><td><a href="javascript:alert('+i+')">- 删除游玩人</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:alert('+i+')">+ 添加游玩人</a></td></tr></table>')
				}
				EL2.innerHTML = Contact.join('');
			}else{
				$('Creat_order').innerHTML = "";
				DOM.removeClass($('add_order'),'hid');
			}
		}else{
			$('Creat_order').innerHTML = "";
			DOM.removeClass($('add_order'),'hid');
		}
	}
};					   
EV.onDOMReady(function(){
	var b = new Totalorders();
	b.bind();
});
	
</script>
</body>
</html>
