xui.util.NumberUtil={add:function(s1,s2,opt){if(!opt){opt="+"}s1=this.toNumber(s1);s2=this.toNumber(s2);if(this.isInt(s1)&&this.isInt(s2)){return eval("s1"+opt+"s2")}s1=this.toString(s1);s2=this.toString(s2);var m=Math.pow(10,Math.max(this.getDigitsLength(s1),this.getDigitsLength(s2)));var n1=this.multiply(s1,m);var n2=this.multiply(s2,m);return(!opt||opt=="-")?this.divide(n1-n2,m):this.divide(n1+n2,m)},subtract:function(b,a){return this.add(b,a,"-")},_insertString:function(b,a,c){return b.substring(0,c)+a+b.slice(c)},toString:function(o){if(o==null||typeof o=="undefined"){return""}var b=this.toNumber(o);var m=b.toString().toLowerCase();if(m.indexOf("e")<=0){return m}var f=Math.abs(b).toString();var c=f.indexOf(".");var d=f.indexOf("e");var l=f.substring(0,d);var a=f.slice(d+1);if(a==""||a=="+"||a=="-"||this.isZero(a)){return(Math.abs(b)!=b)?"-"+l:l}var k=l.replace(".","").replace(/0/g,"");var j=c<0?0:d-c-1;var h=[];pLen=Math.abs(a);if(this.isPlus(a)){for(var e=0;e<pLen;e++){h.push("0")}k=k+h.join("");if(j>0){k=this._insertString(k,".",k.length-j)}}else{for(var e=0,g=pLen+j;e<g;e++){h.push("0")}k=h.join("")+k;k=this._insertString(k,".",k.length-j-pLen)}k=k.replace(/^0+\./g,"0.");k=k.replace(/0+$/g,"");return(Math.abs(b)!=b)?"-"+k:k},multiply:function(c,b){c=this.toNumber(c);b=this.toNumber(b);if(b==0||c==0){return 0}if(this.isInt(c)&&this.isInt(b)){return c*b}if(c===1){return b}if(b===1){return c}var a=0;c=this.toString(c);b=this.toString(b);try{a+=c.split(".")[1].length}catch(d){}try{a+=b.split(".")[1].length}catch(d){}return Number(c.replace(".",""))*Number(b.replace(".",""))/Math.pow(10,a)},divide:function(e,c){e=this.toNumber(e);c=this.toNumber(c);if(e==0){return 0}if(c==0){alert("\u95c4\u3086\u669f\u6d93\u5d88\u5158\u6d93\u6d2a\u6d42");return null}e=this.toString(e);c=this.toString(c);var b=this.getDigitsLength(e);var a=this.getDigitsLength(c);var f=Number(e.replace(".",""));var d=Number(c.replace(".",""));return this.multiply(f/d,Math.pow(10,a-b))},toNumber:function(a){if(!this.isNumber(a)){return 0}if(typeof a=="string"){var b=parseFloat(a.replace(/,/g,""));return isNaN(b)?0:b}else{return Number(a)}},toInt:function(a,b){if(this.isInt(a)){return a}if(!b){b=0}switch(b){case 0:return Math.round(this.toNumber(a));break;case 1:return Math.ceil(this.toNumber(a));break;case 2:return Math.floor(this.toNumber(a));break}},isNumber:function(a){if(a==null||typeof a=="undefined"){return false}if(typeof a=="number"){return true}else{if(typeof a=="string"){if(a.toLowerCase().indexOf("e")>=0){return !isNaN(a)}if(a.indexOf(",")>0){var d=a.lastIndexOf(",");var b=a.lastIndexOf(".");if(d>b&&b>-1){return false}}var c=a.replace(/,/g,"");return(!c||isNaN(c))?false:true}}return false},isFloat:function(a){if(!this.isNumber(a)){return false}a=a.toString();var b=a.replace(/,/g,"");if(b.indexOf(".")>=0){return true}return false},isInt:function(a){if(!this.isNumber(a)){return false}return !this.isFloat(a)},isZero:function(a){if(!this.isNumber(a)){return false}return parseFloat(a)==0},isNegative:function(a){if(!this.isNumber(a)){return false}var b=this.toNumber(a);return !this.isZero(a)&&Math.abs(b)!=b},isPlus:function(a){if(!this.isNumber(a)){return false}var b=this.toNumber(a);return !this.isZero(a)&&Math.abs(b)==b},reverseValue:function(a){if(!this.isNumber(a)){return 0}if(this.isNegative(a)){return this.toNumber(a.toStirng().slice(1))}return this.toNumber("-"+a)},absValue:function(a){if(!this.isNumber(a)){return 0}return Math.abs(a)},getDigitsLength:function(a){if(!this.isNumber(a)){return -1}if(this.isInt(a)){return 0}a=a.toString();var b=a.split(".")[1];return b?b.toString().length:0},getIntegersLength:function(a){if(!this.isNumber(a)){return -1}return this.toInt(a).toString().length},round:function(a,c){if(!this.isNumber(a)){return 0}var b=this.toNumber(a);if(this.isInt(b)){return b}if(!c){c=0}else{if(!this.isInt(c)||c<0){c=3}}return xui.util.NumberUtil.toNumber(b.toFixed(c))},formatMoney:function(l,g,f){if(!this.isNumber(l)){return"0"}if(!g){g="#,###.###"}var a=g.split(".");var i=parseInt(a[1].length);if(f){var e=this.round(l,i).toFixed(i).toString()}else{var e=this.round(l,i).toString()}if(a[0].indexOf(",")>0){var b=false;if(this.isNegative(e)){b=true;e=e.slice(1)}var c=(this.isFloat(e))?e.indexOf("."):e.length;if(c<=i){return e}var d=[];var j=0;var h=c%3;while(h<=e.length){var k=e.slice(j,h);if(k){d[d.length]=k}j=h;if(h==(c-3)){h=e.length}else{h+=3}}return((b)?"-":"")+d.join(",")}return e},calc:function(d,a,c){var b=null;switch(a){case"+":b=this.add(d,c);break;case"-":b=this.subtract(d,c);break;case"*":b=this.multiply(d,c);break;case"\\":b=this.divide(d,c);break}return b},arth:function(){if(arguments==null||arguments.length<=0){return null}var a=null;for(var b=1;b<arguments.length;b=b+2){if(b==1){a=this.calc(arguments[b-1],arguments[b],arguments[b+1])}else{a=this.calc(a,arguments[b],arguments[b+1])}}return a}};
